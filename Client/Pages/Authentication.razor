@page "/authentication/{action}"
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication
@inject NavigationManager NavigationManager
@inject AuthenticationStateProvider AuthenticationStateProvider

@*For some reason, the OnLogOutSucceeded event handler does not work here*@
<RemoteAuthenticatorView Action="@Action" OnLogInSucceeded="OnLogIn">
    <LogOutSucceeded>
        @InvokeAsync(() => NavigationManager.NavigateTo("/landing"))
    </LogOutSucceeded>
</RemoteAuthenticatorView>

@code{
    [Parameter] public string? Action { get; set; }

    private async void OnLogIn()
    {
        var authenticationState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
        var user = authenticationState.User;
        if (user.Identity is not null && user.Identity.IsAuthenticated)
        {
            // @user.Claims.FirstOrDefault(x => x.Type.Equals("oid"))?.Value
            // @user.Identity.Name
        }
    }
}
