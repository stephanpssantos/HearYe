steps:

# Get azuresql-appregsecret from keyvault
#- task: AzureKeyVault@1
#  displayName: 'Get db key from kv'
#  inputs:
#    azureSubscription: ${{ parameters.azureSubscription }}
#    KeyVaultName: ${{ parameters.kvName }}
#    SecretsFilter: 'azuresql-appregsecret'
#    RunAsPreJob: false

# Get graph-appregsecret from keyvault
#- task: AzureKeyVault@1
#  displayName: 'Get graph key from kv'
#  inputs:
#    azureSubscription: ${{ parameters.azureSubscription }}
#    KeyVaultName: ${{ parameters.kvName }}
#    SecretsFilter: 'graph-appregsecret'
#    RunAsPreJob: false

# Azure Container Apps deploy
- task: AzureContainerAppsRC@0
  displayName: 'Deploy to azure container app'
  inputs:
    azureSubscription: ${{ parameters.azureSubscription }}
    containerAppName: ${{ parameters.apiName }}
    resourceGroup: 'hearye'
    imageToDeploy: 'docker.io/stephansantos/hearye-docker:v1.$(Build.BuildId)'